{
  "setup-worktree": [
    "npm install --silent",
    "[ ! -f .clasp.json ] && { ORIGINAL=$(git worktree list | awk 'NR==1 {print $1}'); [ -f \"$ORIGINAL/.clasp.json\" ] && cp \"$ORIGINAL/.clasp.json\" .clasp.json || ([ -f .clasp.json.example ] && cp .clasp.json.example .clasp.json); }",
    "[ ! -f .env ] && { ORIGINAL=$(git worktree list | awk 'NR==1 {print $1}'); [ -f \"$ORIGINAL/.env\" ] && cp \"$ORIGINAL/.env\" .env || ([ -f .env.example ] && cp .env.example .env); }",
    "[ ! -f src/apps-script/appsscript.json ] && echo '❌ Missing src/apps-script/appsscript.json' && exit 1",
    "ls src/apps-script/*.gs > /dev/null 2>&1 || (echo '❌ No .gs files found in src/apps-script/' && exit 1)",
    "[ ! -f .claspignore ] && echo '❌ Missing .claspignore' && exit 1",
    "[ -f .clasp.json ] && node -e \"try { require('./.clasp.json'); } catch(e) { console.error('❌ .clasp.json is invalid JSON:', e.message); process.exit(1); }\"",
    "node -e \"try { require('./src/apps-script/appsscript.json'); } catch(e) { console.error('❌ appsscript.json is invalid JSON:', e.message); process.exit(1); }\"",
    "npm run 2>&1 | grep -q 'clasp:push' || (echo '❌ Missing required npm scripts' && exit 1)",
    "if [ -f .beads/issues.jsonl ] && command -v bd > /dev/null 2>&1; then bd sync > /dev/null 2>&1 || true; fi"
  ]
}
